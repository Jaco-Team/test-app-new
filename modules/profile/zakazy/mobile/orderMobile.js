import { useEffect, useState } from 'react';

import Link from 'next/link';

import { useProfileStore } from '@/components/store.js';
import { useSession } from 'next-auth/react';

import Box from '@mui/material/Box';

import OrdersItemMobile from './orderItemMobile';
import ModalOrderYear from './modalOrderYear';
import ModalOrderMobile from './modalOrderMobile';
import ModalOrderMobileDelete from './modalOrderMobileDelete';

import { ArrowLeftMobile, VectorDownMobile } from '@/ui/Icons.js';

const listOrders = [
  {
    year: '2023',
    orders: [
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '565480',
        year: '2023',
        date: '2023-08-25',
        time: '20:17:58',
        date_time: '2023-08-25 20:17:58',
        is_pred: '1',
        is_delete: '0',
        status_order: 'Предзаказ',
        sum: '99518',
        type_order: '1',
        unix_time_to_client: '50-80',
        type_status: 0,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '560703',
        year: '2023',
        date: '2023-08-11',
        time: '19:35:10',
        date_time: '2023-08-11 19:35:10',
        is_pred: '0',
        is_delete: '0',
        status_order: 'На кухне',
        sum: '979',
        type_order: '1',
        unix_time_to_client: '50-80',
        type_status: 5,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '558872',
        year: '2023',
        date: '2023-08-05',
        time: '18:32:25',
        date_time: '2023-08-05 18:32:25',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Везем',
        sum: '979',
        type_order: '1',
        unix_time_to_client: '45-75',
        type_status: 2,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '549478',
        year: '2023',
        date: '2023-07-07',
        time: '15:41:33',
        date_time: '2023-07-07 15:41:33',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Готовим',
        sum: '1151',
        type_order: '1',
        unix_time_to_client: '30-60',
        type_status: 3,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '538082',
        year: '2023',
        date: '2023-06-02',
        time: '19:16:18',
        date_time: '2023-06-02 19:16:18',
        is_pred: '0',
        is_delete: '1',
        status_order: 'Отменен',
        sum: '956',
        type_order: '1',
        unix_time_to_client: '95-125',
        type_status: -1,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '532516',
        year: '2023',
        date: '2023-05-15',
        time: '20:10:11',
        date_time: '2023-05-15 20:10:11',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Доставлен',
        sum: '1300',
        type_order: '1',
        unix_time_to_client: '40-70',
        type_status: 5,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '529055',
        year: '2023',
        date: '2023-05-05',
        time: '20:03:09',
        date_time: '2023-05-05 20:03:09',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Доставлен',
        sum: '1141',
        type_order: '1',
        unix_time_to_client: '60-90',
        type_status: 5,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '526225',
        year: '2023',
        date: '2023-04-26',
        time: '19:53:54',
        date_time: '2023-04-26 19:53:54',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Доставлен',
        sum: '805',
        type_order: '1',
        unix_time_to_client: '35-65',
        type_status: 5,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '518271',
        year: '2023',
        date: '2023-03-31',
        time: '18:43:49',
        date_time: '2023-03-31 18:43:49',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Доставлен',
        sum: '797',
        type_order: '1',
        unix_time_to_client: '50-80',
        type_status: 5,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '514194',
        year: '2023',
        date: '2023-03-18',
        time: '16:39:12',
        date_time: '2023-03-18 16:39:12',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Доставлен',
        sum: '964',
        type_order: '1',
        unix_time_to_client: '45-80',
        type_status: 5,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '502523',
        year: '2023',
        date: '2023-02-18',
        time: '18:19:53',
        date_time: '2023-02-18 18:19:53',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Доставлен',
        sum: '958',
        type_order: '1',
        unix_time_to_client: '75-110',
        type_status: 5,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '499572',
        year: '2023',
        date: '2023-02-11',
        time: '16:34:32',
        date_time: '2023-02-11 16:34:32',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Ошибка',
        sum: '12958',
        type_order: '2',
        unix_time_to_client: '55-90',
        type_status: 5,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '496905',
        year: '2023',
        date: '2023-02-03',
        time: '18:10:36',
        date_time: '2023-02-03 18:10:36',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Доставлен',
        sum: '955',
        type_order: '1',
        unix_time_to_client: '85-120',
        type_status: 5,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '495039',
        year: '2023',
        date: '2023-01-28',
        time: '19:01:05',
        date_time: '2023-01-28 19:01:05',
        is_pred: '0',
        is_delete: '1',
        status_order: 'Отменен',
        sum: '955',
        type_order: '1',
        unix_time_to_client: '75-110',
        type_status: -1,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '487473',
        year: '2023',
        date: '2023-01-06',
        time: '17:54:09',
        date_time: '2023-01-06 17:54:09',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Доставлен',
        sum: '955',
        type_order: '1',
        unix_time_to_client: '75-110',
        type_status: 5,
      },
    ],
  },
  {
    year: '2022',
    orders: [
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '565480',
        year: '2023',
        date: '2023-08-25',
        time: '20:17:58',
        date_time: '2023-08-25 20:17:58',
        is_pred: '1',
        is_delete: '0',
        status_order: 'Предзаказ',
        sum: '99518',
        type_order: '1',
        unix_time_to_client: '50-80',
        type_status: 0,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '558872',
        year: '2023',
        date: '2023-08-05',
        time: '18:32:25',
        date_time: '2023-08-05 18:32:25',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Готовим',
        sum: '979',
        type_order: '0',
        unix_time_to_client: '45-75',
        type_status: 2,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '549478',
        year: '2023',
        date: '2023-07-07',
        time: '15:41:33',
        date_time: '2023-07-07 15:41:33',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Везем',
        sum: '1151',
        type_order: '0',
        unix_time_to_client: '30-60',
        type_status: 3,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '538082',
        year: '2023',
        date: '2023-06-02',
        time: '19:16:18',
        date_time: '2023-06-02 19:16:18',
        is_pred: '0',
        is_delete: '1',
        status_order: 'Отменен',
        sum: '956',
        type_order: '1',
        unix_time_to_client: '95-125',
        type_status: -1,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '532516',
        year: '2023',
        date: '2023-05-15',
        time: '20:10:11',
        date_time: '2023-05-15 20:10:11',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Доставлен',
        sum: '1300',
        type_order: '1',
        unix_time_to_client: '40-70',
        type_status: 5,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '529055',
        year: '2023',
        date: '2023-05-05',
        time: '20:03:09',
        date_time: '2023-05-05 20:03:09',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Доставлен',
        sum: '1141',
        type_order: '1',
        unix_time_to_client: '60-90',
        type_status: 5,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '526225',
        year: '2023',
        date: '2023-04-26',
        time: '19:53:54',
        date_time: '2023-04-26 19:53:54',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Доставлен',
        sum: '805',
        type_order: '1',
        unix_time_to_client: '35-65',
        type_status: 5,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '518271',
        year: '2023',
        date: '2023-03-31',
        time: '18:43:49',
        date_time: '2023-03-31 18:43:49',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Доставлен',
        sum: '797',
        type_order: '1',
        unix_time_to_client: '50-80',
        type_status: 5,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '514194',
        year: '2023',
        date: '2023-03-18',
        time: '16:39:12',
        date_time: '2023-03-18 16:39:12',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Доставлен',
        sum: '964',
        type_order: '1',
        unix_time_to_client: '45-80',
        type_status: 5,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '502523',
        year: '2023',
        date: '2023-02-18',
        time: '18:19:53',
        date_time: '2023-02-18 18:19:53',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Доставлен',
        sum: '958',
        type_order: '1',
        unix_time_to_client: '75-110',
        type_status: 5,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '499572',
        year: '2023',
        date: '2023-02-11',
        time: '16:34:32',
        date_time: '2023-02-11 16:34:32',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Ошибка',
        sum: '12958',
        type_order: '2',
        unix_time_to_client: '55-90',
        type_status: 5,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '496905',
        year: '2023',
        date: '2023-02-03',
        time: '18:10:36',
        date_time: '2023-02-03 18:10:36',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Доставлен',
        sum: '955',
        type_order: '1',
        unix_time_to_client: '85-120',
        type_status: 5,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '495039',
        year: '2023',
        date: '2023-01-28',
        time: '19:01:05',
        date_time: '2023-01-28 19:01:05',
        is_pred: '0',
        is_delete: '1',
        status_order: 'Отменен',
        sum: '955',
        type_order: '1',
        unix_time_to_client: '75-110',
        type_status: -1,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '487473',
        year: '2023',
        date: '2023-01-06',
        time: '17:54:09',
        date_time: '2023-01-06 17:54:09',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Доставлен',
        sum: '955',
        type_order: '1',
        unix_time_to_client: '75-110',
        type_status: 5,
      },
    ],
  },
  {
    year: '2021',
    orders: [
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '565480',
        year: '2023',
        date: '2023-08-25',
        time: '20:17:58',
        date_time: '2023-08-25 20:17:58',
        is_pred: '1',
        is_delete: '0',
        status_order: 'Предзаказ',
        sum: '99518',
        type_order: '1',
        unix_time_to_client: '50-80',
        type_status: 0,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '558872',
        year: '2023',
        date: '2023-08-05',
        time: '18:32:25',
        date_time: '2023-08-05 18:32:25',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Готовим',
        sum: '979',
        type_order: '1',
        unix_time_to_client: '45-75',
        type_status: 2,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '538082',
        year: '2023',
        date: '2023-06-02',
        time: '19:16:18',
        date_time: '2023-06-02 19:16:18',
        is_pred: '0',
        is_delete: '1',
        status_order: 'Отменен',
        sum: '956',
        type_order: '1',
        unix_time_to_client: '95-125',
        type_status: -1,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '532516',
        year: '2023',
        date: '2023-05-15',
        time: '20:10:11',
        date_time: '2023-05-15 20:10:11',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Доставлен',
        sum: '1300',
        type_order: '1',
        unix_time_to_client: '40-70',
        type_status: 5,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '529055',
        year: '2023',
        date: '2023-05-05',
        time: '20:03:09',
        date_time: '2023-05-05 20:03:09',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Доставлен',
        sum: '1141',
        type_order: '1',
        unix_time_to_client: '60-90',
        type_status: 5,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '526225',
        year: '2023',
        date: '2023-04-26',
        time: '19:53:54',
        date_time: '2023-04-26 19:53:54',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Доставлен',
        sum: '805',
        type_order: '1',
        unix_time_to_client: '35-65',
        type_status: 5,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '518271',
        year: '2023',
        date: '2023-03-31',
        time: '18:43:49',
        date_time: '2023-03-31 18:43:49',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Доставлен',
        sum: '797',
        type_order: '1',
        unix_time_to_client: '50-80',
        type_status: 5,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '514194',
        year: '2023',
        date: '2023-03-18',
        time: '16:39:12',
        date_time: '2023-03-18 16:39:12',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Доставлен',
        sum: '964',
        type_order: '1',
        unix_time_to_client: '45-80',
        type_status: 5,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '502523',
        year: '2023',
        date: '2023-02-18',
        time: '18:19:53',
        date_time: '2023-02-18 18:19:53',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Доставлен',
        sum: '958',
        type_order: '1',
        unix_time_to_client: '75-110',
        type_status: 5,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '499572',
        year: '2023',
        date: '2023-02-11',
        time: '16:34:32',
        date_time: '2023-02-11 16:34:32',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Ошибка',
        sum: '12958',
        type_order: '2',
        unix_time_to_client: '55-90',
        type_status: 5,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '496905',
        year: '2023',
        date: '2023-02-03',
        time: '18:10:36',
        date_time: '2023-02-03 18:10:36',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Доставлен',
        sum: '955',
        type_order: '1',
        unix_time_to_client: '85-120',
        type_status: 5,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '495039',
        year: '2023',
        date: '2023-01-28',
        time: '19:01:05',
        date_time: '2023-01-28 19:01:05',
        is_pred: '0',
        is_delete: '1',
        status_order: 'Отменен',
        sum: '955',
        type_order: '1',
        unix_time_to_client: '75-110',
        type_status: -1,
      },
      {
        base: 'jaco_rolls_1',
        point_id: '1',
        order_id: '487473',
        year: '2023',
        date: '2023-01-06',
        time: '17:54:09',
        date_time: '2023-01-06 17:54:09',
        is_pred: '0',
        is_delete: '0',
        status_order: 'Доставлен',
        sum: '955',
        type_order: '1',
        unix_time_to_client: '75-110',
        type_status: 5,
      },
    ],
  },
];

export default function OrderMobile({ city, this_module }) {
  const [list, setList] = useState([]);

  const [getOrderList, orderList, year, setActiveModalYear, setYear] =
    useProfileStore((state) => [state.getOrderList, state.orderList, state.year, state.setActiveModalYear, state.setYear]);

  const session = useSession();

  useEffect(() => {
    if (session.data?.user?.token) {
      getOrderList(this_module, city, session.data?.user?.token);
    }
  }, [session]);

  useEffect(() => {
    if (year) {
      //const list = orderList.find((item) => item.year === year);
      const list = listOrders.find((item) => item.year === year);
      setList(list);
    } else {
      // setList(orderList[0]);
      // setYear(orderList[0]?.year);
      setList(listOrders[0]);
      setYear(listOrders[0]?.year);
    }
  }, [orderList, year]);

  return (
    <Box sx={{ display: { xs: 'flex', md: 'flex', lg: 'none' } }} className="ZakazyMobile">
      <div className="zakazyLogin">
        <Link href={'/' + city + '/account'}>
          <ArrowLeftMobile />
        </Link>
        <div className="loginContainer">
          <span>{list?.year}</span>
          <VectorDownMobile onClick={() => setActiveModalYear(true, listOrders)}/>
        </div>
      </div>
      <div className="zakazyList">
        <div className="zakazyHead">
          <span>номер</span>
          <span>статус</span>
          <span>дата</span>
          <span>стоимость</span>
        </div>
        {list?.orders?.map((order, ykey) => (
          <OrdersItemMobile
            key={ykey}
            order={order}
            token={session.data?.user?.token}
            this_module={this_module}
            city={city}
            last={order === list?.orders?.at(-1) ? 'last' : ''}
          />
        ))}
      </div>

      <ModalOrderYear />
      <ModalOrderMobile />
      <ModalOrderMobileDelete />
    </Box>
  );
}
